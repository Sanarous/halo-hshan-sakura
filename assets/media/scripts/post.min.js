var tocId="#toc",flagId="#tocFlag",post={appreciateModel:function(){$(".appreciate-btn").on("click",(function(e){$(".qr-code-wrap").velocity("transition.expandIn",{duration:300}),$(document).one("click",(function(){$(".qr-code-wrap").velocity("transition.expandOut",{duration:300})})),e.stopPropagation()}))},toggleSocialShare:function(){$(".share-btn").on("click",(function(e){var icons=$("#socialShare");icons.hasClass("show")?$("#socialShare").velocity("transition.slideUpOut",{duration:300}):$("#socialShare").velocity("transition.slideDownIn",{duration:300}),icons.toggleClass("show")}))},appreciate:function(){$(".qr-code").on("click",(function(e){e.stopPropagation()})),$(".closinglayer").on("click",(function(e){$(".qr-code-wrap").velocity("transition.expandOut",{duration:300})})),$(".zfb-btn").on("click",(function(e){$(".qr_code_zfb").css("height","300px"),$(".qr_code_wx").css("height","0")})),$(".wx-btn").on("click",(function(e){$(".qr_code_wx").css("height","300px"),$(".qr_code_zfb").css("height","0")}))},removeFirstUL:function(){var post_content=document.getElementById("post-content"),firstNodeName;post_content&&("UL"===post_content.firstElementChild.nodeName&&$(post_content.firstElementChild).hide())},getScrollTop:function(){return document.documentElement.scrollTop||document.body.scrollTop},tocScroll:function(event){var Obj=$(flagId);if(1!==Obj.length)return!1;var tocFixed=$(tocId),ObjTop=Obj.offset().top-.5*$(window).height(),scrollTop=post.getScrollTop(),postHeaderHeight;scrollTop>$("#postHeader").height()?tocFixed.show():tocFixed.hide();var tocEle=document.querySelector(tocId),tocHeight;tocEle&&tocEle.getBoundingClientRect()&&(scrollTop>ObjTop-.5*tocEle.getBoundingClientRect().height?tocFixed.addClass("right-fixed"):tocFixed.removeClass("right-fixed"),post.tocParentActive(),event.preventDefault())},scrollTocFixed:function(){window.addEventListener("scroll",post.tocScroll,!1)},initToc:function(){var headerEl="h1,h2,h3,h4,h5,h6",content="#post-article-content";tocbot.init({tocSelector:"#toc",contentSelector:content,headingSelector:headerEl,scrollSmooth:!0,headingsOffset:0-$("#postHeader").height()+$("#siteHeader").height(),hasInnerContainers:!1,scrollSmoothOffset:-$("#siteHeader").height()}),$(".toc-link").each((function(){var linkContent=$(this).html();$(this).html('<span class="toc-link-dot"></span>'+linkContent)})),post.tocEleRight()},tocEleRight:function(){var screenWidth=document.body.clientWidth,tocEle=document.getElementById("toc");tocEle&&(tocEle.style.left=(screenWidth-800)/2+850+"px")},readProgress:function(){var $content=$("#main"),$readProgressBar=$("#readProgress .read-progress-bar"),changeReadProgress=function(){var contentHeight=$content.height()-window.innerHeight;if(!(contentHeight<=0)){var readHeight,progressWidth=(window.pageYOffset-$content.offset().top)/contentHeight*100+"%";$readProgressBar.width(progressWidth)}};displayReadProgress&&changeReadProgress(),$(window).on("scroll",(function(){displayReadProgress&&changeReadProgress()}))},initViewer:function(){document.getElementById("post-content")&&new Viewer(document.getElementById("post-content"),{toolbar:!1})},loadHighlight:function(){$("pre").addClass("line-numbers")},tocHover:function(){$(".toc-list-item span").hover((function(){$(this).parent().find("a.toc-link:first").addClass("toc-hover")}),(function(){$(this).parent().find("a.toc-link:first").removeClass("toc-hover")}))},tocParentActive:function(){var isCollapsible=$(".is-active-li").parents("ol.toc-list.is-collapsible");isCollapsible&&isCollapsible.each((function(){$(this).parent().find("a.toc-link:first").addClass("toc-hover")}));var isCollapsed=$("ol.toc-list.is-collapsible.is-collapsed");isCollapsed&&isCollapsed.each((function(){$(this).parent().find("a.toc-link:first").removeClass("toc-hover")}))},shareIcon:function(){var $config={sites:["google","twitter","facebook","weibo","qq","tencent","qzone","linkedin","wechat","douban","diandian"],disabled:socialDisabled.split(",")};socialShare(".social-share",$config)},expandCode:function(){$(".code-toolbar").dblclick((function(){$(this).hasClass("code-block-fullscreen")?($(this).removeClass("code-block-fullscreen"),$("html").removeClass("code-block-fullscreen-html-scroll")):($(this).addClass("code-block-fullscreen"),$("html").addClass("code-block-fullscreen-html-scroll"))})),$(document).keyup((function(e){var key;27==(e.which||e.keyCode)&&$(".code-toolbar").hasClass("code-block-fullscreen")&&($(".code-toolbar").removeClass("code-block-fullscreen"),$("html").removeClass("code-block-fullscreen-html-scroll"))}))}};$((function(){post.appreciate(),post.initToc(),post.removeFirstUL(),post.scrollTocFixed(),post.readProgress(),post.loadHighlight(),post.appreciateModel(),post.toggleSocialShare(),post.initViewer(),post.tocHover(),post.expandCode()}));
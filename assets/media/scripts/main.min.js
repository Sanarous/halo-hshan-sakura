var videoEmbeds=['iframe[src*="youtube.com"]','iframe[src*="vimeo.com"]'];reframe(videoEmbeds.join(","));var currBgId="white-bg",fontfamilyId="serif",commentId="Twikoo",katex_config={delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]},sidebarToggle=document.querySelectorAll(".sidebar-toggle"),oldScrollTop;if(sidebarToggle)for(var i=0;i<sidebarToggle.length;i++)sidebarToggle[i].addEventListener("click",(function(e){var menuCtrl=$("#sidebarToggle");menuCtrl&&menuCtrl.toggleClass("menu-ctrl-on");var scrollMenu=$("#scrollMenu");scrollMenu&&scrollMenu.toggleClass("scroll-menu-show");var siteHeader=$("#siteHeader");siteHeader&&siteHeader.toggleClass("site-header-scroll"),siteHeader.toggleClass("site-header-bg");var sideBar=$("#sidebar");sideBar&&sideBar.toggleClass("sidebar-show"),e.preventDefault(),$(document.body).toggleClass("cancel-scroll")}),{passive:!1});var han={lazyLoad:function(){$("#page").velocity("transition.slideDownBigIn",{stagger:200})},initLazyLoad:function(){$("#page").removeClass("transform-none")},refreshLazyLoad:function(){$("#page").addClass("transform-none")},lazyLoadCardItem:function(){$(".card-item-vel").velocity("transition.slideUpIn",{stagger:200,display:"flex"})},linksAddBlank:function(){var links=$(".post-content a");if(links)for(var i=0;i<links.length;i++)$(links[i]).attr("target","_blank")},getScrollTop:function(){var scrollTop=0;return document.documentElement&&document.documentElement.scrollTop?scrollTop=document.documentElement.scrollTop:document.body&&(scrollTop=document.body.scrollTop),scrollTop},scollHeader:function(){window.addEventListener("scroll",(function(){var siteHeader=$("#siteHeader"),scrollMenu=$("#scrollMenu"),sidebarToggle=$("#sidebarToggle"),scrollTop=han.getScrollTop();siteHeader&&scrollTop>0?(siteHeader.addClass("site-header-scroll"),scrollMenu.addClass("scroll-menu-show"),sidebarToggle.hide()):(siteHeader.removeClass("site-header-scroll"),scrollMenu.removeClass("scroll-menu-show"),sidebarToggle.show()),oldScrollTop=scrollTop}),!1)},toggleSearch:function(){$(".js-toggle-search").on("click",(function(){openSearchPanel(),$(".searchbox-input").focus(),this.makeMenuInvisible()}))},makeMenuInvisible:function(){$("#sidebar").removeClass("sidebar-show"),$("#sidebarToggle").removeClass("menu-ctrl-on"),$(document.body).removeClass("sidebar-opened"),$(document.body).removeClass("cancel-scroll"),$(".side-bar-val").velocity("transition.slideUpOut",{stagger:200})},highlightMenu:function(){for(var nav,links=document.getElementById("scrollMenu").getElementsByTagName("a"),currenturl=document.location.href,last=0,i=0;i<links.length;i++){var linkurl=links[i].getAttribute("href");-1!==currenturl.indexOf(linkurl)&&(last=i)}$(links[last]).addClass("active-current");for(var i=0;i<links.length;i++)last!==i&&$(links[i]).removeClass("active-current");var currentLinks=links[last];if($(currentLinks).parents(".sub-menu")){var subMenu=$(currentLinks).parents(".sub-menu");$(subMenu[0]).siblings("a").addClass("active-current")}},foldSubMenu:function(){$(".nav-menu-link").click((function(e){var angle=$(this).children(".fa")[0];$(angle).toggleClass("angle-transform");var subMenu=$(this).siblings(".nav-sub-menu");subMenu&&!$(this).siblings(".nav-sub-menu").hasClass("nav-menu-show")?(subMenu.velocity("transition.slideDownIn",{duration:300}),subMenu.addClass("nav-menu-show")):subMenu&&$(this).siblings(".nav-sub-menu").hasClass("nav-menu-show")&&(subMenu.velocity("transition.slideUpOut",{duration:300}),subMenu.removeClass("nav-menu-show"))}))},pagination:function(){$body=window.opera?"CSS1Compat"==document.compatMode?$("html"):$("body"):$("html,body"),$("body").on("click","#pagination a",(function(){var pageContent=$("#pagination");return pageContent.html(""),pageContent.append('<div class="loader-inner ball-pulse"><div/><div/><div/></div>'),$.ajax({type:"GET",url:$(this).attr("href"),success:function(data){result=$(data).find("#post-list .postItem"),pageInner=$(data).find("#pagination .inner"),$("#post-list").html(result.fadeIn(500)),pageContent.empty(),pageContent.append(pageInner),document.getElementById("postContainer").scrollIntoView()}}),!1}))},changeBg:function(){var local_currBgId=hanUtils.getLocalStorage(currBgId);null==local_currBgId?hanUtils.setLocalStorage(currBgId,"white-bg"):($("body").hasClass("night")&&$("#nightMode").click(),"sakura-bg"==local_currBgId?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/sakura.png)"):"gribs-bg"==local_currBgId?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/plaid2dbf8.jpg)"):"KAdots-bg"==local_currBgId?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/kyotoanimation.png)"):"totem-bg"==local_currBgId?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/dot_orange.gif)"):"pixiv-bg"==local_currBgId?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/star02.png)"):"bing-bg"==local_currBgId?$("body").css("background-image","url(https://api.mashiro.top/bing)"):"white-bg"==local_currBgId?$("body").css("background-image","none"):($("body").css("background-image","none"),$("#nightMode").click())),$(".changeSkin-gear").off("click").on("click",(function(){$(".skin-menu").toggleClass("show")})),$(".theme-controls").find("li").click((function(){"dark-bg"!=$(this).attr("id")&&$("body").hasClass("night")&&$("#nightMode").click(),"sakura-bg"==$(this).attr("id")?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/sakura.png)"):"gribs-bg"==$(this).attr("id")?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/plaid2dbf8.jpg)"):"KAdots-bg"==$(this).attr("id")?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/kyotoanimation.png)"):"totem-bg"==$(this).attr("id")?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/dot_orange.gif)"):"pixiv-bg"==$(this).attr("id")?$("body").css("background-image","url(https://cdn.jsdelivr.net/gh/spirit1431007/cdn@1.6/img/star02.png)"):"bing-bg"==$(this).attr("id")?$("body").css("background-image","url(https://api.mashiro.top/bing)"):"white-bg"==$(this).attr("id")?$("body").css("background-image","none"):($("body").css("background-image","none"),$("#nightMode").click()),hanUtils.setLocalStorage(currBgId,$(this).attr("id")),$(".skin-menu").removeClass("show"),setTimeout((function(){$(".changeSkin-gear").css("visibility","visible")}),300)}));var local_fontfamily=hanUtils.getLocalStorage(fontfamilyId);null==local_fontfamily?hanUtils.setLocalStorage(fontfamilyId,"serif"):"serif"==local_fontfamily?($("body").css("font-family","'Linux Biolinum','Noto Serif SC',Helvetica,Arial,Menlo,Monaco,monospace,sans-serif"),$(".control-btn-serif").addClass("selected"),$(".control-btn-sans-serif").removeClass("selected")):"sans-serif"==local_fontfamily&&($("body").css("font-family","'Merriweather Sans',Helvetica,Tahoma,Arial,'PingFang SC','Hiragino Sans GB','Microsoft Yahei','WenQuanYi Micro Hei',sans-serif"),$(".control-btn-sans-serif").addClass("selected"),$(".control-btn-serif").removeClass("selected")),$(".changefont").click((function(){$(this).hasClass("control-btn-serif")?($("body").css("font-family","'Linux Biolinum','Noto Serif SC',Helvetica,Arial,Menlo,Monaco,monospace,sans-serif"),$(this).addClass("selected"),$(".control-btn-sans-serif").removeClass("selected"),hanUtils.setLocalStorage(fontfamilyId,"serif")):$(this).hasClass("control-btn-sans-serif")&&($("body").css("font-family","'Merriweather Sans',Helvetica,Tahoma,Arial,'PingFang SC','Hiragino Sans GB','Microsoft Yahei','WenQuanYi Micro Hei',sans-serif"),$(this).addClass("selected"),$(".control-btn-serif").removeClass("selected"),hanUtils.setLocalStorage(fontfamilyId,"sans-serif")),$(".skin-menu").removeClass("show"),setTimeout((function(){$(".changeSkin-gear").css("visibility","visible")}),300)}))},changeComment:function(){var local_commentId=hanUtils.getLocalStorage(commentId);null==local_commentId?hanUtils.setLocalStorage(commentId,"Twikoo"):"Twikoo"==local_commentId?($(".comments-items-2").css({display:"none",animation:"0.5s ease 0s 1 normal none running tabshow"}),$(".comments-items-1").css({display:"block",animation:"0.5s ease 0s 1 normal none running tabshow"})):($(".comments-items-1").css({display:"none",animation:"0.5s ease 0s 1 normal none running tabshow"}),$(".comments-items-2").css({display:"block",animation:"0.5s ease 0s 1 normal none running tabshow"})),$(".comment-switch").find(".slider").click((function(){"none"!=$(".comments-items-1").css("display")?($(".comments-items-1").css({display:"none",animation:"0.5s ease 0s 1 normal none running tabshow"}),$(".comments-items-2").css({display:"block",animation:"0.5s ease 0s 1 normal none running tabshow"}),hanUtils.setLocalStorage(commentId,"sakura")):($(".comments-items-2").css({display:"none",animation:"0.5s ease 0s 1 normal none running tabshow"}),$(".comments-items-1").css({display:"block",animation:"0.5s ease 0s 1 normal none running tabshow"}),hanUtils.setLocalStorage(commentId,"Twikoo"))}))}};$((function(){han.lazyLoadCardItem(),han.linksAddBlank(),han.scollHeader(),han.toggleSearch(),han.highlightMenu(),han.foldSubMenu(),han.getScrollTop(),han.changeBg()})),$(document).ready((function(){var treeHoleBoxs=document.querySelectorAll(".tree-hole-box");if(treeHoleBoxs)for(var i=0;i<treeHoleBoxs.length;i++){for(var childrens=$(treeHoleBoxs[i]).children("p:empty"),j=0;j<childrens.length;j++)childrens[j].remove();document.getElementById("post-content")&&$(".post-content img").each((function(index,item){$(this).hasClass("prevent")||$($(this)).wrap("<a data-fancybox='images' href='"+$(this)[0].src+"'></a>")}))}}));